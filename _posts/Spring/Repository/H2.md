---
aliases:
  - H2
tags:
  - Spring
  - DB
  - spring/Repository
특징: 
---
# H2
기본적으로 DataSource 데이터가 없는 경우 Spring 테스트 동작 시 자체적으로 알아서 임베디드 데이터베이스를 동작
## Database URLs
- Embedded
	- `jdbc:h2:~/test` 
	- 자동으로 만들지 않아서 불편
- ✨File
	- `jdbc:h2:file:./jpashop-server-db;AUTO_SERVER=TRUE`
	- 정해진 위치에 스스로 파일을 만들어서 편함
- In-Memory
	- `jdbc:h2:mem:test`
- Server Mode
	- `jdbc:h2:tcp://localhost/~/test`
## 임베디드 데이터베이스
```java title:"임베디드 데이터베이스(메모리DB)"
	@Bean
	@Profile("test")
	public DataSource dataSource() {
		DriverManagerDataSource dataSource = new DriverManagerDataSource();
		dataSource.setDriverClassName("org.h2.Driver");
		dataSource.setUrl("jdbc:h2:mem:test;DB_CLOSE_DELAY=-1");
		dataSource.setUsername("sa");
		dataSource.setPassword("");
		return dataSource;
	
```
1. `DB_CLOSE_DELAY=-1` 부분은 임베디드 모드에서는 데이터베이스 커넥션 연결이 모두 끊어지면 데이터베이스도 종료되는데 그것을 방지하는 설정

